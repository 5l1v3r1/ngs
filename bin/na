#!/usr/bin/env ngs

F process_argv(argv:Arr) {
	ret = {
		'anchor': {'Tags': {}}
		'options': {}
	}
	for arg in (iter = Iter(argv)) {
		econd {
			m = arg ~ Pfx('--') {
				ret.options[m.after] = iter.next()
			}
			m = arg ~ /=/ {
				ret.anchor.Tags[m.before] = m.after
			}
			m = arg ~ /:/ {
				ret.anchor[m.before] = m.after
			}
		}
	}
	ret
}

processed_argv = process_argv(ARGV[1..null])
res = AWS::q(ARGV[0], **processed_argv.anchor).find()
echo(Table2::Table(res.resources.props))
